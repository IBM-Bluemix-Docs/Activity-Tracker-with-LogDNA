---

copyright:
  years: 2019
lastupdated: "2019-06-03"

keywords: IBM Cloud, LogDNA, Activity Tracker, monitor events

subcollection: logdnaat

---

{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:pre: .pre}
{:table: .aria-labeledby="caption"}
{:codeblock: .codeblock}
{:tip: .tip}
{:download: .download}
{:important: .important}
{:note: .note}


# アカウント内のアクティビティーのモニター
{: #monitor_events}

{{site.data.keyword.at_full_notm}} Web UI を使用して、アカウント内のアクティビティーをモニターできます。イベントのセットをエクスポートして、異なるコンテキストで分析することもできます。
{:shortdesc}

ロケーションごとに {{site.data.keyword.at_full_notm}} サービスのインスタンスが 1 つあります。したがって、アカウント内のアクティビティーをモニターする際に、複数の異なる {{site.data.keyword.at_full_notm}} インスタンスを介してイベントを表示し、分析することが必要な場合があります。 

{{site.data.keyword.cloud_notm}} で、**「メニュー」**アイコン ![「メニュー」アイコン](../icons/icon_hamburger.svg) > **「プログラム識別情報」** > **「Activity Tracker」**をクリックすると、アカウントにプロビジョンされているすべてのインスタンスがリストされたダッシュボードが表示されます。
{: tip}

イベントを表示するには、イベントが使用可能なロケーションで [Web UI を起動](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-launch)する必要があります。 その後、ビューを操作してそれらのイベントをモニターできます。イベントはユーザーの現地時間で表示されます。

タイム・スタンプまたは検索照会、あるいはその両方を適用することにより、ビューで表示されるイベントを選択できます。

* 検索照会を適用し、それをカスタム・ビューとして保存できます。 
* タイム・スタンプを適用することで、イベント・ログ内の特定の時刻にジャンプできます。 

検索照会を適用した場合、後で再利用できるようにそのビューを保存できます。ただし、タイム・スタンプは保存されません。

インスタンス間でサービス・プランが異なるために、Web UI でデータを検索できる日数を決定するそれらのデータ保存期間が異なる可能性があることに注意してください。イベントをモニターできるのは保存期間内のみです。保存期間は[サービス・プラン](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-service_plan)によって異なります。


## グローバル・イベントとロケーション・ベースのイベントのモニター
{: #mon_def_event_type}

イベントは、グローバルまたはロケーション・ベースに分類できます。どこでイベントをモニターする必要があるかは、イベントのタイプによって決まります。

グローバル・イベントの共通テーマは、アカウント管理者がクラウド全体で特定のタイプのアクティビティーをモニターできる単一の同期ロケーションです。一方、ロケーション・ベースのイベントは、サブスクライブしているクラウド・サービスがホストされているロケーションのローカルにとどまります。
{: note}

### グローバル・イベント
{: #mon_def_global}

**グローバル・イベント**は、すべての地域で全般的に同期しているデータとリソースに関連するアカウント内アクティビティーについて報告します。
{: note}

ユーザーが対話するサービスは、グローバル {{site.data.keyword.cloud_notm}} エクスペリエンスの中核に組み込まれています。

グローバル・ドメインは**フランクフルト**で設定されます。グローバル・イベントは、フランクフルトで構成された {{site.data.keyword.at_full_notm}} インスタンスを介して取り込まれ、使用可能になります。

例えば、アカウント管理者がユーザーをアカウントに参加するよう招待した場合、ユーザーはクラウド内の任意のロケーションからアカウントに参加できます。フランクフルトが所在地であるユーザーを招待し、ダラスでプロビジョンされたサービスを使用して作業する権限をそのユーザーに付与することもできます。イベントはどこにあるのでしょうか。答えはグローバル・ドメインです。グローバル・ドメインは起点にもロケーションにも依存せず、すべての地域で情報が同期しています。
    
別の例として、IBM Cloud ではリソース・コントローラー・イベントもグローバル・イベントと見なされます。これらのイベントは、クラウド全体におけるサービス・インスタンスのプロビジョニングと削除を報告します。サービス・インスタンスは特定のロケーションに作成されますが、リソース・コントローラー・アクションはグローバル・イベントとして報告され、アカウントを介してプロビジョンされているすべてのサービス・インスタンスの単一ビューを提供します。


### ロケーション・ベースのイベント
{: #mon_def_location}

**ロケーション・ベースのイベント**は、{{site.data.keyword.cloud_notm}} データ・センターのロケーション (ダラスやフランクフルトなど) 内でホストされている {{site.data.keyword.IBM_notm}} サービスによって生成されたアカウント内アクティビティーについて報告します。
{: note}


クライアントとアプリケーションが、ロケーション内でホストされているクラウド・サービスと対話すると、ロケーション・ベースのイベントが取り込まれ、そのロケーションで構成された {{site.data.keyword.at_full_notm}} インスタンスを介して使用可能になります。これらのイベントを表示するには、そのロケーションで [Web UI を起動](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-launch)します。
    
ロケーション・ベースのイベントは、そのクラウド・ロケーションで実行されるサービスのデータ局所性を維持します。

例えば、フランクフルト・ロケーションに {{site.data.keyword.cloudcerts_short}} サービスをプロビジョンした場合、そのインスタンスからのイベントは、フランクフルトにプロビジョンされた {{site.data.keyword.at_full_notm}} インスタンスに送信されます。ダラス・ロケーションに {{site.data.keyword.cloudcerts_short}} サービスをプロビジョンした場合、そのインスタンスからのイベントは、ダラスにプロビジョンされた {{site.data.keyword.at_full_notm}} インスタンスに送信されます。どちらの場合も、サブスクライブしているクラウド・サービスの地域とロケーション内のみにイベントがとどめられます。




## デフォルト・ビューでのイベントのモニター
{: #mon_def_view}

デフォルト・ビューの名前は**「すべて (Everything)」**です。 

あるロケーションで Web UI を開くと、使用するビューはこれになります。 

インスタンス内のすべてのイベントがこのビューで表示されます。

このビューでイベントを表示する方法については、[イベントの表示](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-view_events#view_events_step1)を参照してください。

## カスタム・ビューでのイベントのモニター
{: #mon_cus_view}

アカウント内のイベントのセットをモニターすることもできます。イベントのサブセットを分析するには、カスタム・ビューを作成します。 

カスタム・ビューを作成するには、ビューで表示するイベントを定義した検索照会を適用する必要があります。[詳細はこちら](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-view_events#view_events_step2)。

カスタム・ビューに[アラートをアタッチ](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-alerts)できます。 

カスタム・ビューから[データをエクスポート](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-export)できます。 

[ビューの名前変更、説明の追加または変更](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-views#views_step5)を行えます。 

ビューに[行テンプレートを適用](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-views#views_step4)して、データの表示方法をカスタマイズできます。 

ビューを **カテゴリー* にグループ化することによって、ビューを編成できます。


## 時間フレームを適用したイベントのモニター
{: #mon_time_view}

特定の時間フレーム内のイベントを調べることができます。

[時間フレームを適用する](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-view_events#view_events_step3)ことによって、ビューで表示されるイベントを選択できます。

絶対時刻、相対時間、または時刻範囲を指定してタイム・スタンプを適用できます。

* 絶対時刻の場合は、イベント・ログ内の厳密な時点を指定します (例: `May 20 7:00pm`)。
    
* 相対時刻の場合は、厳密でない時間フレームを指定します (例: `2 days ago`)。

* 時刻範囲の場合は、時間間隔を指定します (例: `yesterday 10am to yesterday 11am`)。



## アラートの構成
{: #mon_alerts}

アカウント内で特定のイベントが生成された場合に、通知されるようにしたい場合があります。例えば、失敗したアクションの数が指定しきい値を超えたら通知されるようにしたい場合などがあります。 

{{site.data.keyword.at_full_notm}} の Web UI で、検索照会を適用することで、カスタム・ビューで表示されるイベントを定義できます。その後、条件が発生したときに通知するアラートをそのビューにアタッチできます。ビューと共にベルのアイコンが表示されると、このビューにアラートがアタッチされていることを示しています。

* 1 つのビューにつき [1 つのアラートをアタッチ](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-alerts#alerts_step4)できます。
* ビュー内の検索照会に一致するイベント行の数、または時間頻度、あるいはその両方に基づいた条件を構成できます。
* 1 つのアラートについて複数の通知チャネルを定義できます。 サポートされるチャネルについては、[アラート通知チャネル](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-channels)を参照してください。
* [**事前設定**を定義](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-alerts#alerts_step3)できます。事前設定とは、任意の数のビューにアタッチできるアラート・テンプレートのことです。事前設定を使用して、ユーザーがアラートをビューにアタッチするときに再利用できるテンプレートを定義できます。 
* アラートをミュートすることができます。 
* ビューから[アラートをデタッチ](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-alerts#alerts_delete_view)できます。 


### アラート・タイプ
{: #mon_alerts_types}

以下のタイプのアラートを構成できます。

* **存在アラート (Presence alert)**: このタイプのアラートを使用すると、ビューに表示されるイベントの数が予想より多い場合に通知します。 
* **不在アラート (Absence alert)**: このタイプのアラートを使用すると、ビューに表示されるイベントの数が予想より少ない場合や存在しない場合に通知します。 

例えば、アカウント内のサービス・インスタンスの削除を報告するイベントを表示するビューがあるとします。サービス・インスタンスの削除は予期されていません。1 つ以上のイベントがビューに表示されるとアラートをトリガーする*存在アラート** を構成できます。

不在アラートは、イベントがビューに表示された後に有効になります。
{: note}


### アラート条件
{: #mon_alerts_conditions}

アラートに対して、以下の条件をどれでも構成できます。

* **時間頻度**: この条件を設定することにより、アラートをトリガーする頻度を指定します。有効な値は、30 秒、1 分、5 分、15 分、30 分、1 時間、6 時間、12 時間、24 時間です
* **イベント行カウンター**: この条件を設定することにより、ビューのフィルターと検索基準に一致するイベント行の数を指定します。このイベント行の数に達すると、アラートがトリガーされます。

両方の条件とも検査するか、一方の条件のみにするかを決めることができます。 両方の条件とも設定した場合は、いずれかのしきい値に達するとアラートがトリガーされます。 

*イベント行カウンター* を、アラートがトリガーされる唯一の条件として設定した場合は、条件の構成時に設定した時間頻度によって、アラートがトリガーされた後にアラート条件がリセットされるまでの時間が決まります。
{: note}

例えば、30 秒後か、またはビューのフィルターと検索基準に一致するイベント行が 100 行収集されると、アラートがトリガーされるように構成できます。



## イベントのエクスポート
{: #mon_export}

問題をより詳細に調査するために、Web UI 外でイベントのセットにアクセスすることが必要な場合があります。 

データを JSONL 形式で {{site.data.keyword.at_full_notm}} インスタンスからローカル・ファイルにエクスポートできます。 

イベントのエクスポートは、Web UI のビューを使用して、または REST API を使用してプログラマチックに行えます。

イベントをエクスポートする際は、以下の情報を考慮してください。
* イベント項目のセットをエクスポートします。 
* エクスポートしようとしているデータ集合を定義する際に、フィルターと検索を適用できます。 時刻範囲を指定することもできます。 
* エクスポートできる最大行数は 20,000 です。

### REST API を使用
{: #mon_export_api}

LogDNA REST API を使用して、イベントをプログラマチックにエクスポートできます。[詳細はこちら](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-export#export_api)。

イベントをプログラマチックにエクスポートする場合は、以下の情報を考慮してください。

* E メールを送信するか、イベントを端末にストリーミングするかを選択できます。
* エクスポート REST API 呼び出しを行うときに使用する必要がある資格情報を渡すために使用されるサービス・キーを使用する必要があります。 

    Web UI でサービス・キーを表示および生成するには、{{site.data.keyword.at_full_notm}} インスタンスまたはサービスに対する**管理者**役割が必要です。


### Web UI のビューを使用
{: #mon_export_ui}

Web UI のビューを使用してイベントをエクスポートできます。 

Web UI で、エクスポートするデータを表示するビューを選択できます。このビューで、**「行のエクスポート (Export Lines)」**タスクを選択する必要があります。時刻範囲と、新しい行をエクスポートするか古い行をエクスポートするかを指定する必要があります。その後、エクスポートを要求できます。 

要求を送信すると、自分の E メール・アドレス宛の E メールを受け取ります。この E メールには、当該データが含まれる圧縮ファイルへのリンクがあります。 
* このデータを取得するには、リンクをクリックし、圧縮ファイルをダウンロードしなければなりません。 
* エクスポートしようとしているデータが含まれる圧縮ファイルは、最大 48 時間入手可能です。 

[Web UI を使用したイベントのエクスポートについての詳細はこちらをご覧ください](/docs/services/Activity-Tracker-with-LogDNA?topic=logdnaat-export#export_ui)。








